(()=>{var e={102:function(e,t,r){!function(e,t,r){"use strict";var n,o,i,s,a,l,c;t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,(s=e.UiExtensionErrorCode||(e.UiExtensionErrorCode={})).ConnectionDestroyed="ConnectionDestroyed",s.DialogCanceled="DialogCanceled",s.DialogExists="DialogExists",s.IncompatibleParent="IncompatibleParent",s.InternalError="InternalError",s.NotInIframe="NotInIframe",(i=e.UiStyling||(e.UiStyling={})).Classic="classic",i.Material="material",(o=e.DocumentEditorMode||(e.DocumentEditorMode={})).View="view",o.Compare="compare",o.Edit="edit",(n=e.DialogSize||(e.DialogSize={})).Large="large",n.Medium="medium",n.Small="small";class d extends Error{constructor(e,t){super(t),this.code=e,this.message=t,Object.setPrototypeOf(this,new.target.prototype)}toPromise(){return Promise.reject(this)}static fromPenpal(e){const t=d.convertPenpalErrorCode(e);return new d(t,e.message)}static convertPenpalErrorCode(t){switch(t.code){case r.ERR_NOT_IN_IFRAME:return e.UiExtensionErrorCode.NotInIframe;case r.ERR_CONNECTION_DESTROYED:return e.UiExtensionErrorCode.ConnectionDestroyed;case"DialogCanceled":return e.UiExtensionErrorCode.DialogCanceled;case"DialogExists":return e.UiExtensionErrorCode.DialogExists;default:return e.UiExtensionErrorCode.InternalError}}}class u{constructor(e){this._parent=e}call(t,...r){if(!this._parent[t])return new d(e.UiExtensionErrorCode.IncompatibleParent,`missing ${t}()`).toPromise();try{return this._parent[t](...r).catch(u.convertPenpalError)}catch(e){return u.convertPenpalError(e)}}static convertPenpalError(e){return d.fromPenpal(e).toPromise()}}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f.apply(this,arguments)}const h="channel",E=Symbol("parent"),p=Symbol("eventEmitter"),m=Symbol("eventScope"),g=Symbol("fieldDomObserver"),v=Symbol("fieldOverflowStyle"),y=Symbol("fieldHeight"),_=Symbol("fieldHeightMode"),R=Symbol("fieldHeightListener");function w(e,t,r){let n;Object.defineProperty(e,t,{get:()=>(void 0===n&&(n=r()),n),configurable:!1,enumerable:!0})}class O{constructor(e){this[E]=e}}class b extends O{constructor(e,t,r){super(e),this[p]=t,this[m]=r}on(e,t){return this[p].on(`${this[m]}.${e}`,t)}}class N extends b{get(){return this[E].call("getPage")}refresh(){return this[E].call("refreshPage")}}class C extends b{constructor(e,t,r){super(e,t,r),w(this,"page",(()=>new N(e,t,"channel.page")))}refresh(){return this[E].call("refreshChannel")}}class P extends O{constructor(e){super(e),w(this,"field",(()=>new I(this[E])))}get(){return this[E].call("getDocument")}navigate(e){return this[E].call("navigateDocument",e)}open(e){return this[E].call("openDocument",e)}}function S(){"auto"!==this[_]&&(document.body.addEventListener("load",this[R],!0),this[g].observe(document.body,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),this[_]="auto",this[v]=document.body.style.overflowY,document.body.style.overflowY="hidden")}function T(){"auto"===this[_]&&(document.body.removeEventListener("load",this[R],!0),this[g].disconnect(),this[_]="manual",document.body.style.overflowY=this[v])}function D(e){if(this[y]!==e)return this[y]=e,this[E].call("setFieldHeight",e)}class I extends O{constructor(e){super(e),this[a]="manual",this[l]=()=>D.call(this,document.body.scrollHeight),this[c]=new MutationObserver(this[R]),window.addEventListener("focus",(()=>e.call("emitEvent","document.field.focus"))),window.addEventListener("blur",(()=>e.call("emitEvent","document.field.blur")))}getValue(...e){return this[E].call("getFieldValue",...e)}getCompareValue(...e){return this[E].call("getFieldCompareValue",...e)}setValue(e){return this[E].call("setFieldValue",e)}setHeight(e){return"auto"===e?S.call(this)||Promise.resolve():(T.call(this),D.call(this,e)||Promise.resolve())}}a=_,l=R,c=g;class M extends O{constructor(e){super(e),window.addEventListener("keydown",(({which:e})=>27===e&&this.cancel()))}cancel(){return this[E].call("cancelDialog")}close(e){return this[E].call("closeDialog",e)}open(e){return this[E].call("openDialog",e)}options(){return this[E].call("getDialogOptions")}}class A extends O{constructor(e,t){super(e),w(this,"channel",(()=>new C(e,t,h))),w(this,"dialog",(()=>new M(e))),w(this,"document",(()=>new P(e)))}init(){return this[E].call("getProperties").then((e=>f(this,e)))}}class L{static register(){const e=new URLSearchParams(window.location.search).get("br.parentOrigin"),n=new t;return function(e,t){try{return r.connectToParent({parentOrigin:e,methods:{emitEvent:t.emit.bind(t)}}).promise.then((e=>new u(e)))}catch(e){return d.fromPenpal(e).toPromise()}}(e,n).then((e=>new A(e,n).init()))}}const x=L.register;e.default=L,e.register=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,r(148),r(493))},148:e=>{"use strict";const t=new WeakMap,r=new WeakMap,n=new WeakMap,o=Symbol("anyProducer"),i=Promise.resolve(),s=Symbol("listenerAdded"),a=Symbol("listenerRemoved");function l(e){if("string"!=typeof e&&"symbol"!=typeof e)throw new TypeError("eventName must be a string or a symbol")}function c(e){if("function"!=typeof e)throw new TypeError("listener must be a function")}function d(e,t){const n=r.get(e);return n.has(t)||n.set(t,new Set),n.get(t)}function u(e,t){const r="string"==typeof t?t:o,i=n.get(e);return i.has(r)||i.set(r,new Set),i.get(r)}function f(e,t){let r=!1,n=()=>{},o=[];const i={enqueue(e){o.push(e),n()},finish(){r=!0,n()}};return u(e,t).add(i),{async next(){return o?0===o.length?r?(o=void 0,this.next()):(await new Promise((e=>{n=e})),this.next()):{done:!1,value:await o.shift()}:{done:!0}},async return(r){return o=void 0,u(e,t).delete(i),n(),arguments.length>0?{done:!0,value:await r}:{done:!0}},[Symbol.asyncIterator](){return this}}}function h(e){if(void 0===e)return m;if(!Array.isArray(e))throw new TypeError("`methodNames` must be an array of strings");for(const t of e)if(!m.includes(t)){if("string"!=typeof t)throw new TypeError("`methodNames` element must be a string");throw new Error(`${t} is not Emittery method`)}return e}const E=e=>e===s||e===a;class p{static mixin(e,t){return t=h(t),r=>{if("function"!=typeof r)throw new TypeError("`target` must be function");for(const e of t)if(void 0!==r.prototype[e])throw new Error(`The property \`${e}\` already exists on \`target\``);Object.defineProperty(r.prototype,e,{enumerable:!1,get:function(){return Object.defineProperty(this,e,{enumerable:!1,value:new p}),this[e]}});const n=t=>function(...r){return this[e][t](...r)};for(const e of t)Object.defineProperty(r.prototype,e,{enumerable:!1,value:n(e)});return r}}constructor(){t.set(this,new Set),r.set(this,new Map),n.set(this,new Map)}on(e,t){return l(e),c(t),d(this,e).add(t),E(e)||this.emit(s,{eventName:e,listener:t}),this.off.bind(this,e,t)}off(e,t){l(e),c(t),E(e)||this.emit(a,{eventName:e,listener:t}),d(this,e).delete(t)}once(e){return new Promise((t=>{l(e);const r=this.on(e,(e=>{r(),t(e)}))}))}events(e){return l(e),f(this,e)}async emit(e,r){l(e),function(e,t,r){const i=n.get(e);if(i.has(t))for(const e of i.get(t))e.enqueue(r);if(i.has(o)){const e=Promise.all([t,r]);for(const t of i.get(o))t.enqueue(e)}}(this,e,r);const s=d(this,e),a=t.get(this),c=[...s],u=E(e)?[]:[...a];return await i,Promise.all([...c.map((async e=>{if(s.has(e))return e(r)})),...u.map((async t=>{if(a.has(t))return t(e,r)}))])}async emitSerial(e,r){l(e);const n=d(this,e),o=t.get(this),s=[...n],a=[...o];await i;for(const e of s)n.has(e)&&await e(r);for(const t of a)o.has(t)&&await t(e,r)}onAny(e){return c(e),t.get(this).add(e),this.emit(s,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return f(this)}offAny(e){c(e),this.emit(a,{listener:e}),t.get(this).delete(e)}clearListeners(e){if("string"==typeof e){d(this,e).clear();const t=u(this,e);for(const e of t)e.finish();t.clear()}else{t.get(this).clear();for(const e of r.get(this).values())e.clear();for(const e of n.get(this).values()){for(const t of e)t.finish();e.clear()}}}listenerCount(e){if("string"==typeof e)return t.get(this).size+d(this,e).size+u(this,e).size+u(this).size;void 0!==e&&l(e);let o=t.get(this).size;for(const e of r.get(this).values())o+=e.size;for(const e of n.get(this).values())o+=e.size;return o}bindMethods(e,t){if("object"!=typeof e||null===e)throw new TypeError("`target` must be an object");t=h(t);for(const r of t){if(void 0!==e[r])throw new Error(`The property \`${r}\` already exists on \`target\``);Object.defineProperty(e,r,{enumerable:!1,value:this[r].bind(this)})}}}const m=Object.getOwnPropertyNames(p.prototype).filter((e=>"constructor"!==e));p.Typed=class extends p{},Object.defineProperty(p.Typed,"Typed",{enumerable:!1,value:void 0}),Object.defineProperty(p,"listenerAdded",{value:s,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(p,"listenerRemoved",{value:a,writable:!1,enumerable:!0,configurable:!1}),e.exports=p},409:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(9),o=r(996);t.default=(e,t,r)=>{const i=e.localName,s=e.local,a=e.remote,l=e.originForSending,c=e.originForReceiving;let d=!1;r(`${i}: Connecting call receiver`);const u=e=>{if(e.source!==a||e.data.penpal!==n.CALL)return;if(e.origin!==c)return void r(`${i} received message from origin ${e.origin} which did not match expected origin ${c}`);const s=e.data,u=s.methodName,f=s.args,h=s.id;r(`${i}: Received ${u}() call`);const E=e=>t=>{if(r(`${i}: Sending ${u}() reply`),d)return void r(`${i}: Unable to send ${u}() reply due to destroyed connection`);const s={penpal:n.REPLY,id:h,resolution:e,returnValue:t};e===n.REJECTED&&t instanceof Error&&(s.returnValue=(0,o.serializeError)(t),s.returnValueIsError=!0);try{a.postMessage(s,l)}catch(e){throw e.name===n.DATA_CLONE_ERROR&&a.postMessage({penpal:n.REPLY,id:h,resolution:n.REJECTED,returnValue:(0,o.serializeError)(e),returnValueIsError:!0},l),e}};new Promise((e=>e(t[u].apply(t,f)))).then(E(n.FULFILLED),E(n.REJECTED))};return s.addEventListener(n.MESSAGE,u),()=>{d=!0,s.removeEventListener(n.MESSAGE,u)}},e.exports=t.default},701:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=r(9),i=r(740),s=(n=r(445))&&n.__esModule?n:{default:n},a=r(996);t.default=(e,t,r,n,l)=>{const c=t.localName,d=t.local,u=t.remote,f=t.originForSending,h=t.originForReceiving;let E=!1;return l(`${c}: Connecting call sender`),r.reduce(((e,t)=>(e[t]=(e=>function(){for(var t=arguments.length,r=new Array(t),p=0;p<t;p++)r[p]=arguments[p];let m;l(`${c}: Sending ${e}() call`);try{u.closed&&(m=!0)}catch(e){m=!0}if(m&&n(),E){const t=new Error(`Unable to send ${e}() call due to destroyed connection`);throw t.code=i.ERR_CONNECTION_DESTROYED,t}return new Promise(((t,n)=>{const i=(0,s.default)(),E=r=>{if(r.source!==u||r.data.penpal!==o.REPLY||r.data.id!==i)return;if(r.origin!==h)return void l(`${c} received message from origin ${r.origin} which did not match expected origin ${h}`);l(`${c}: Received ${e}() reply`),d.removeEventListener(o.MESSAGE,E);let s=r.data.returnValue;r.data.returnValueIsError&&(s=(0,a.deserializeError)(s)),(r.data.resolution===o.FULFILLED?t:n)(s)};d.addEventListener(o.MESSAGE,E),u.postMessage({penpal:o.CALL,id:i,methodName:e,args:r},f)}))})(t),e)),e),()=>{E=!0}},e.exports=t.default},543:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(9),o=r(740),i=d(r(443)),s=d(r(491)),a=d(r(392)),l=d(r(409)),c=d(r(701));function d(e){return e&&e.__esModule?e:{default:e}}t.default=e=>{let t=e.iframe,r=e.methods,d=void 0===r?{}:r,u=e.childOrigin,f=e.timeout,h=e.debug;const E=(0,a.default)(h),p=window,m=(0,i.default)(),g=m.destroy,v=m.onDestroy;if(!u){if(!t.src&&!t.srcdoc){const e=new Error("Iframe must have src or srcdoc property defined.");throw e.code=o.ERR_NO_IFRAME_SRC,e}u=(0,s.default)(t.src)}const y="null"===u?"*":u;return{promise:new Promise(((e,r)=>{let i;void 0!==f&&(i=setTimeout((()=>{const e=new Error(`Connection to child timed out after ${f}ms`);e.code=o.ERR_CONNECTION_TIMEOUT,r(e),g()}),f));const s={};let a,h;const m=r=>{const o=t.contentWindow;if(r.source!==o||r.data.penpal!==n.HANDSHAKE)return;if(r.origin!==u)return void E(`Parent received handshake from origin ${r.origin} which did not match expected origin ${u}`);E("Parent: Received handshake, sending reply"),r.source.postMessage({penpal:n.HANDSHAKE_REPLY,methodNames:Object.keys(d)},y);const f={localName:"Parent",local:p,remote:o,originForSending:y,originForReceiving:u};h&&h(),h=(0,l.default)(f,d,E),v(h),a&&a.forEach((e=>{delete s[e]})),a=r.data.methodNames;const m=(0,c.default)(s,f,a,g,E);v(m),clearTimeout(i),e(s)};p.addEventListener(n.MESSAGE,m),E("Parent: Awaiting handshake");var _=setInterval((()=>{document.contains(t)||(clearInterval(_),g())}),6e4);v((()=>{p.removeEventListener(n.MESSAGE,m),clearInterval(_);const e=new Error("Connection destroyed");e.code=o.ERR_CONNECTION_DESTROYED,r(e)}))})),destroy:g}},e.exports=t.default},804:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(9),o=r(740),i=c(r(443)),s=c(r(409)),a=c(r(701)),l=c(r(392));function c(e){return e&&e.__esModule?e:{default:e}}t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parentOrigin,r=void 0===t?"*":t,c=e.methods,d=void 0===c?{}:c,u=e.timeout,f=e.debug;const h=(0,l.default)(f);if(window===window.top){const e=new Error("connectToParent() must be called within an iframe");throw e.code=o.ERR_NOT_IN_IFRAME,e}const E=(0,i.default)(),p=E.destroy,m=E.onDestroy,g=window,v=g.parent,y=new Promise(((e,t)=>{let i;void 0!==u&&(i=setTimeout((()=>{const e=new Error(`Connection to parent timed out after ${u}ms`);e.code=o.ERR_CONNECTION_TIMEOUT,t(e),p()}),u));const l=t=>{try{clearTimeout()}catch(e){return}if(t.source!==v||t.data.penpal!==n.HANDSHAKE_REPLY)return;if("*"!==r&&r!==t.origin)return void h(`Child received handshake reply from origin ${t.origin} which did not match expected origin ${r}`);h("Child: Received handshake reply"),g.removeEventListener(n.MESSAGE,l);const o={localName:"Child",local:g,remote:v,originForSending:"null"===t.origin?"*":t.origin,originForReceiving:t.origin},c={},u=(0,s.default)(o,d,h);m(u);const f=(0,a.default)(c,o,t.data.methodNames,p,h);m(f),clearTimeout(i),e(c)};g.addEventListener(n.MESSAGE,l),m((()=>{g.removeEventListener(n.MESSAGE,l);const e=new Error("Connection destroyed");e.code=o.ERR_CONNECTION_DESTROYED,t(e)})),h("Child: Sending handshake"),v.postMessage({penpal:n.HANDSHAKE,methodNames:Object.keys(d)},r)}));return{promise:y,destroy:p}},e.exports=t.default},9:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DATA_CLONE_ERROR=t.MESSAGE=t.REJECTED=t.FULFILLED=t.REPLY=t.CALL=t.HANDSHAKE_REPLY=t.HANDSHAKE=void 0,t.HANDSHAKE="handshake",t.HANDSHAKE_REPLY="handshake-reply",t.CALL="call",t.REPLY="reply",t.FULFILLED="fulfilled",t.REJECTED="rejected",t.MESSAGE="message",t.DATA_CLONE_ERROR="DataCloneError"},443:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=()=>{const e=[];let t=!1;return{destroy(){t=!0,e.forEach((e=>{e()}))},onDestroy(r){t?r():e.push(r)}}},e.exports=t.default},392:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=e=>function(){if(e){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];console.log("[Penpal]",...r)}},e.exports=t.default},740:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERR_NO_IFRAME_SRC=t.ERR_NOT_IN_IFRAME=t.ERR_CONNECTION_TIMEOUT=t.ERR_CONNECTION_DESTROYED=void 0,t.ERR_CONNECTION_DESTROYED="ConnectionDestroyed",t.ERR_CONNECTION_TIMEOUT="ConnectionTimeout",t.ERR_NOT_IN_IFRAME="NotInIframe",t.ERR_NO_IFRAME_SRC="NoIframeSrc"},996:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeError=t.serializeError=void 0,t.serializeError=e=>({name:e.name,message:e.message,stack:e.stack}),t.deserializeError=e=>{const t=new Error;return Object.keys(e).forEach((r=>t[r]=e[r])),t}},445:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;let r=0;t.default=()=>++r,e.exports=t.default},491:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const r={"http:":"80","https:":"443"},n=/^(https?:)?\/\/([^/:]+)?(:(\d+))?/,o=["file:","data:"];t.default=e=>{if(e&&o.find((t=>e.startsWith(t))))return"null";const t=document.location,i=n.exec(e);let s,a,l;return i?(s=i[1]?i[1]:t.protocol,a=i[2],l=i[4]):(s=t.protocol,a=t.hostname,l=t.port),`${s}//${a}${l&&l!==r[s]?`:${l}`:""}`},e.exports=t.default},493:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(543)),o=s(r(804)),i=r(740);function s(e){return e&&e.__esModule?e:{default:e}}var a={ERR_CONNECTION_DESTROYED:i.ERR_CONNECTION_DESTROYED,ERR_CONNECTION_TIMEOUT:i.ERR_CONNECTION_TIMEOUT,ERR_NOT_IN_IFRAME:i.ERR_NOT_IN_IFRAME,ERR_NO_IFRAME_SRC:i.ERR_NO_IFRAME_SRC,connectToChild:n.default,connectToParent:o.default};t.default=a,e.exports=t.default}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(102),t=r.n(e);!function(){document.addEventListener("DOMContentLoaded",(()=>{t().register().then((t=>{r(t),t.channel.page.on("navigate",(()=>{r(t)})),e("refreshChannel",(()=>t.channel.refresh())),e("refreshPage",(()=>t.channel.page.refresh()))}))}));const e=(e,t)=>{document.getElementById(e).addEventListener("click",t)},r=e=>{e.channel.page.get().then((t=>{console.log(t);const r=t.path,n=JSON.parse(e.extension.config).spaUrl;console.log("URL",n+r),document.getElementById("previewButton").href=n+r+"?preview=true"}))}}()})()})();